<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Conveniently download gridded time series data for Norway from NVE • rgts</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Conveniently download gridded time series data for Norway from NVE">
<meta name="description" content="A set of functions for accessing and downloading the GridTimeSeries (GTS) data (api.nve.no/doc/gridtimeseries-data-gts/) from the Norwegian Water Resources and Energy Directorate (NVE). This data reposiory contains 1x1 km gridded time series data for Norway and includes several weather and environmental parameters, such as temperature, precipitation, wind direction and strength and snow depth.">
<meta property="og:description" content="A set of functions for accessing and downloading the GridTimeSeries (GTS) data (api.nve.no/doc/gridtimeseries-data-gts/) from the Norwegian Water Resources and Energy Directorate (NVE). This data reposiory contains 1x1 km gridded time series data for Norway and includes several weather and environmental parameters, such as temperature, precipitation, wind direction and strength and snow depth.">
<meta property="og:image" content="https://thomas-kvalnes.github.io/rgts/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rgts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomas-kvalnes/rgts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rgts-">rgts <a class="anchor" aria-label="anchor" href="#rgts-"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of rgts is to provide convenient methods for accessing and downloading the GridTimeSeries (GTS) data for Norway (api.nve.no/doc/gridtimeseries-data-gts/) from the Norwegian Water Resources and Energy Directorate (NVE). This data reposiory contains 1x1 km gridded time series data for Norway and includes several weather and environmental parameters, such as temperature, precipitation, wind direction and strength and snow depth. Data is available at 1h, 3h and daily intervals depending on the variable of interest. Many of the daily variables go back from present to 1957. Questions about the data should be directed to NVE, the author only maintains the rgts-package which access the data.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of rgts from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"thomas-kvalnes/rgts"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thomas-kvalnes/rgts" class="external-link">rgts</a></span><span class="op">)</span></span></code></pre></div>
<p>The variables available in the GridTimeSeries (GTS) data can be listed using gts_parameters(). Here we show the first five:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/gts_parameters.html">gts_parameters</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Name            Fullname NoDataValue RawUnit HumanReadableUnit</span></span>
<span><span class="co">#&gt; 1   rr          Døgnnedbør       65535      mm                mm</span></span>
<span><span class="co">#&gt; 2 rr3d Nedbør siste 3 døgn       65535      mm                mm</span></span>
<span><span class="co">#&gt; 3 rr1h       Nedbør 1 time       65535      mm                mm</span></span>
<span><span class="co">#&gt; 4 rr3h      Nedbør 3 timer       65535      mm                mm</span></span>
<span><span class="co">#&gt; 5  rrl                Regn       65535      mm                mm</span></span>
<span><span class="co">#&gt;   TimeResolutionInMinutes FirstDateInTimeSerie</span></span>
<span><span class="co">#&gt; 1                    1440           1957-01-01</span></span>
<span><span class="co">#&gt; 2                    1440           2010-01-01</span></span>
<span><span class="co">#&gt; 3                      60           2010-01-01</span></span>
<span><span class="co">#&gt; 4                     180           2010-01-01</span></span>
<span><span class="co">#&gt; 5                    1440           1957-01-01</span></span></code></pre></div>
<p>If we have some points of interest we can download data for the points in grid cells using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a data frame with coordinates</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58200</span>, <span class="fl">74225</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6708225</span>, <span class="fl">6715025</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Download data</span></span>
<span><span class="fu"><a href="reference/gts_dl_coords.html">gts_dl_coords</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">coords</span>, env_layer <span class="op">=</span> <span class="st">"tm"</span>, start_date <span class="op">=</span> <span class="st">"2023-12-01"</span>, end_date <span class="op">=</span> <span class="st">"2023-12-02"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       x       y cellindex altitude       date  time time_resolution_minutes</span></span>
<span><span class="co">#&gt; 1 58200 6708225   1542878     1294 2023-12-01 00:00                    1440</span></span>
<span><span class="co">#&gt; 2 58200 6708225   1542878     1294 2023-12-02 00:00                    1440</span></span>
<span><span class="co">#&gt; 3 74225 6715025   1534529     1371 2023-12-01 00:00                    1440</span></span>
<span><span class="co">#&gt; 4 74225 6715025   1534529     1371 2023-12-02 00:00                    1440</span></span>
<span><span class="co">#&gt;      unit    tm</span></span>
<span><span class="co">#&gt; 1 Celcius -13.8</span></span>
<span><span class="co">#&gt; 2 Celcius -13.0</span></span>
<span><span class="co">#&gt; 3 Celcius -15.2</span></span>
<span><span class="co">#&gt; 4 Celcius -14.1</span></span></code></pre></div>
<p>Lets create a polygon, which we imagine covers an area of interest at Hardangervidda in Norway.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a sf polygon</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE</span></span>
<span><span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58200</span>, <span class="fl">74225</span>, <span class="fl">58200</span>, <span class="fl">74226</span><span class="op">)</span></span>
<span><span class="va">yy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6708225</span>, <span class="fl">6708225</span>, <span class="fl">6715025</span>, <span class="fl">6715025</span><span class="op">)</span></span>
<span><span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xx</span>, y <span class="op">=</span> <span class="va">yy</span><span class="op">)</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">25833</span><span class="op">)</span></span>
<span><span class="va">pol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">points</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now take this polygon and download daily temperature data (“tm”) for all grid cells within the polygon. First we need to convert the polygon to json using the function sf_to_json(). We only show the first 10 lines of data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Convert to json</span></span>
<span><span class="va">pol_json</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gts_sf2json.html">gts_sf2json</a></span><span class="op">(</span><span class="va">pol</span><span class="op">)</span></span>
<span><span class="co">## Download data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/gts_dl_polygon.html">gts_dl_polygon</a></span><span class="op">(</span>polygon <span class="op">=</span> <span class="va">pol_json</span>, env_layer <span class="op">=</span> <span class="st">"tm"</span>, start_date <span class="op">=</span> <span class="st">"2023-12-01"</span>, end_date <span class="op">=</span> <span class="st">"2023-12-01"</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cellindex altitude       date  time time_resolution_minutes    unit    tm</span></span>
<span><span class="co">#&gt; 1    1535708     1245 2023-12-01 00:00                    1440 Celcius -12.9</span></span>
<span><span class="co">#&gt; 2    1535709     1314 2023-12-01 00:00                    1440 Celcius -13.5</span></span>
<span><span class="co">#&gt; 3    1535710     1177 2023-12-01 00:00                    1440 Celcius -12.5</span></span>
<span><span class="co">#&gt; 4    1535711     1083 2023-12-01 00:00                    1440 Celcius -11.9</span></span>
<span><span class="co">#&gt; 5    1535712     1096 2023-12-01 00:00                    1440 Celcius -12.1</span></span>
<span><span class="co">#&gt; 6    1535713     1100 2023-12-01 00:00                    1440 Celcius -12.1</span></span>
<span><span class="co">#&gt; 7    1535714     1136 2023-12-01 00:00                    1440 Celcius -12.4</span></span>
<span><span class="co">#&gt; 8    1535715      975 2023-12-01 00:00                    1440 Celcius -11.6</span></span>
<span><span class="co">#&gt; 9    1535716     1009 2023-12-01 00:00                    1440 Celcius -11.8</span></span>
<span><span class="co">#&gt; 10   1535717      961 2023-12-01 00:00                    1440 Celcius -11.6</span></span></code></pre></div>
<p>Each 1x1 km grid cell have a unique ID, called cellindex. It is faster to query the API using cellindices directly instead of going the way around with polygons. The cellindices for a given polygon can be obtained by</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gts_cellindex.html">gts_cellindex</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">pol</span><span class="op">)</span></span>
<span><span class="va">cells</span></span>
<span><span class="co">#&gt;   [1] 1535708 1535709 1535710 1535711 1535712 1535713 1535714 1535715 1535716</span></span>
<span><span class="co">#&gt;  [10] 1535717 1535718 1535719 1535720 1535721 1535722 1535723 1536903 1536904</span></span>
<span><span class="co">#&gt;  [19] 1536905 1536906 1536907 1536908 1536909 1536910 1536911 1536912 1536913</span></span>
<span><span class="co">#&gt;  [28] 1536914 1536915 1536916 1536917 1536918 1538098 1538099 1538100 1538101</span></span>
<span><span class="co">#&gt;  [37] 1538102 1538103 1538104 1538105 1538106 1538107 1538108 1538109 1538110</span></span>
<span><span class="co">#&gt;  [46] 1538111 1538112 1538113 1539293 1539294 1539295 1539296 1539297 1539298</span></span>
<span><span class="co">#&gt;  [55] 1539299 1539300 1539301 1539302 1539303 1539304 1539305 1539306 1539307</span></span>
<span><span class="co">#&gt;  [64] 1539308 1540488 1540489 1540490 1540491 1540492 1540493 1540494 1540495</span></span>
<span><span class="co">#&gt;  [73] 1540496 1540497 1540498 1540499 1540500 1540501 1540502 1540503 1541683</span></span>
<span><span class="co">#&gt;  [82] 1541684 1541685 1541686 1541687 1541688 1541689 1541690 1541691 1541692</span></span>
<span><span class="co">#&gt;  [91] 1541693 1541694 1541695 1541696 1541697 1541698 1542878 1542879 1542880</span></span>
<span><span class="co">#&gt; [100] 1542881 1542882 1542883 1542884 1542885 1542886 1542887 1542888 1542889</span></span>
<span><span class="co">#&gt; [109] 1542890 1542891 1542892 1542893</span></span></code></pre></div>
<p>Then the daily temperature data can be obtained. Again we only show the first 10 lines of data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Download data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/gts_dl_cellindex.html">gts_dl_cellindex</a></span><span class="op">(</span>cellindex <span class="op">=</span> <span class="va">cells</span>, env_layer <span class="op">=</span> <span class="st">"tm"</span>, start_date <span class="op">=</span> <span class="st">"2023-12-01"</span>, end_date <span class="op">=</span> <span class="st">"2023-12-01"</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cellindex altitude       date  time time_resolution_minutes    unit    tm</span></span>
<span><span class="co">#&gt; 1    1535708     1245 2023-12-01 00:00                    1440 Celcius -12.9</span></span>
<span><span class="co">#&gt; 2    1535709     1314 2023-12-01 00:00                    1440 Celcius -13.5</span></span>
<span><span class="co">#&gt; 3    1535710     1177 2023-12-01 00:00                    1440 Celcius -12.5</span></span>
<span><span class="co">#&gt; 4    1535711     1083 2023-12-01 00:00                    1440 Celcius -11.9</span></span>
<span><span class="co">#&gt; 5    1535712     1096 2023-12-01 00:00                    1440 Celcius -12.1</span></span>
<span><span class="co">#&gt; 6    1535713     1100 2023-12-01 00:00                    1440 Celcius -12.1</span></span>
<span><span class="co">#&gt; 7    1535714     1136 2023-12-01 00:00                    1440 Celcius -12.4</span></span>
<span><span class="co">#&gt; 8    1535715      975 2023-12-01 00:00                    1440 Celcius -11.6</span></span>
<span><span class="co">#&gt; 9    1535716     1009 2023-12-01 00:00                    1440 Celcius -11.8</span></span>
<span><span class="co">#&gt; 10   1535717      961 2023-12-01 00:00                    1440 Celcius -11.6</span></span></code></pre></div>
<p>We can also obtain data aggregated across grid cells. We then need to choose a method for aggregating data, “sum”, “min”, “max”, “avg” or “median”. Choosing “avg” we can obtain daily averages by:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Download data</span></span>
<span><span class="fu"><a href="reference/gts_dl_cellindex_aggr.html">gts_dl_cellindex_aggr</a></span><span class="op">(</span>cellindex <span class="op">=</span> <span class="va">cells</span>, env_layer <span class="op">=</span> <span class="st">"tm"</span>, start_date <span class="op">=</span> <span class="st">"2023-12-01"</span>, end_date <span class="op">=</span> <span class="st">"2023-12-10"</span>, method <span class="op">=</span> <span class="st">"avg"</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date  time time_resolution_minutes    unit     tm_avg</span></span>
<span><span class="co">#&gt; 1  2023-12-01 00:00                    1440 Celcius -13.075893</span></span>
<span><span class="co">#&gt; 2  2023-12-02 00:00                    1440 Celcius -12.500893</span></span>
<span><span class="co">#&gt; 3  2023-12-03 00:00                    1440 Celcius -11.951786</span></span>
<span><span class="co">#&gt; 4  2023-12-04 00:00                    1440 Celcius -12.035714</span></span>
<span><span class="co">#&gt; 5  2023-12-05 00:00                    1440 Celcius -14.912500</span></span>
<span><span class="co">#&gt; 6  2023-12-06 00:00                    1440 Celcius -13.713393</span></span>
<span><span class="co">#&gt; 7  2023-12-07 00:00                    1440 Celcius  -9.762500</span></span>
<span><span class="co">#&gt; 8  2023-12-08 00:00                    1440 Celcius -12.035714</span></span>
<span><span class="co">#&gt; 9  2023-12-09 00:00                    1440 Celcius  -9.708036</span></span>
<span><span class="co">#&gt; 10 2023-12-10 00:00                    1440 Celcius  -6.480357</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/thomas-kvalnes/rgts/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/thomas-kvalnes/rgts/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rgts</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Thomas Kvalnes <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Kvalnes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
